"use strict";angular.module("app",["ngAnimate","ngMaterial","ngMessages","ui.router"]),function(){function t(t,e,n){this.$scope=t,this.$http=e,this.config=n,this.init()}t.$inject=["$scope","$http","configFactory"],angular.module("app").controller("mainCtrl",t),t.prototype.init=function(){var t=this;this.$http.get(this.config.fixtures+"countries.json").then(function(e){t.countries=e.data,t.dataForDiagramm=t.countries[0]})},t.prototype.setCountry=function(t,e){t.preventDefault(),console.log("---ΞΞΞΞ- country -ΞΞΞΞ---",e),this.dataForDiagramm=e}}(),function(){angular.module("app").factory("configFactory",function(){var t={fixtures:"./src/fixtures/",components:"./src/components/"};return{fixtures:t.fixtures,components:t.components}})}(),function(){angular.module("app").factory("ngDgPresetsFactory",function(){var t=500,e=500,n={pathColors:{0:"#f58a41",1:"#f0d367",2:"#e64d1b"},svgWidth:t,svgHeight:e,svgStyles:{width:t,height:e,fill:"blue"},radius:150,animateTime:500,animateStep:1};return{pathColors:n.pathColors,svgWidth:n.svgWidth,svgHeight:n.svgHeight,svgStyles:n.svgStyles,radius:n.radius,animateTime:n.animateTime,animateStep:n.animateStep}})}(),function(){angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,e){var n="./src/components/";e.otherwise("/");var a={main:{templateUrl:n+"main/index.html"}};t.state("home",{url:"/",views:a})}])}(),function(){function t(t,e,n,a){this.$scope=t,this.$element=e,this.$compile=n,this.prs=a,this.init()}t.$inject=["$scope","$element","$compile","ngDgPresetsFactory"],angular.module("app").controller("ngDiagrammCtrl",t),angular.module("app").directive("ngDiagramm",["configFactory",function(e){function n(t,e,n){}var a="ngDiagramm";return{link:n,scope:{},templateUrl:e.components+a+"/"+a+".html",controller:t,controllerAs:"dg",bindToController:{settings:"=?",data:"=?",styles:"=?",pathClick:"=?",ctx:"=?"}}}]),t.prototype.init=function(){var t=this;this.pathes=[],this.circles=[];var e={width:this.prs.svgWidth,height:this.prs.svgHeight,radius:this.prs.radius,center:{x:this.prs.svgWidth/2,y:this.prs.svgHeight/2}};this.$scope.$watch(function(){return t.data},function(n){if(n){t.pathes&&t.pathes.length&&(t.pathes.length=0),e.radius=t.prs.radius,t.circles.length||t.createCircles(e);var a=[],i=[];for(var r in n.data)a.push({value:n.data[r].value,text:n.data[r].text});for(var o=0,s=0;s<a.length;s+=1){for(var c=0,u=0;u<a.length;u+=1)a[s].value<a[u].value&&(c+=1);i.push({a1:3.6*o,a2:3.6*(o+a[s].value),text:a[s].text,value:a[s].value,cutRadius:c}),o+=a[s].value}for(var l=0;l<i.length;l+=1){var h={x1:"",y1:"",x2:"",y2:""},g=t.calculateAbsCoord(i[l].a1,e.center,e.radius-20*i[l].cutRadius);h.x1=g[0],h.y1=g[1],g=t.calculateAbsCoord(i[l].a2,e.center,e.radius-20*i[l].cutRadius),h.x2=g[0],h.y2=g[1];for(var p in h)h[p]=Math.round(h[p]);var d=t.calculateAbsCoord((i[l].a1+i[l].a2)/2,e.center,(e.radius-20*l)/2),f={id:"g_"+(l+1),color:t.prs.pathColors[i[l].cutRadius],value:i[l].value,text:i[l].text,radius:e.radius-20*i[l].cutRadius,showTooltip:i[l].a2-i[l].a1>15,angle:{start:i[l].a1,end:i[l].a2},startPos:{x:h.x1,y:h.y1},endPos:{x:h.x2,y:h.y2},textPosition:{x:d[0],y:d[1]}};t.pathes.push(f),t.pathAnimation(t.pathes[l],e)}}})},t.prototype.calculateAbsCoord=function(t,e,n){var a=[];return t>=0&&t<90?(a[0]=e.x+Math.abs(n*+Math.sin(t*Math.PI/180).toPrecision(10)),a[1]=e.y-Math.abs(n*+Math.cos(t*Math.PI/180).toPrecision(10))):t>=90&&t<180?(a[0]=e.x+Math.abs(n*+Math.sin(t*Math.PI/180).toPrecision(10)),a[1]=e.y+Math.abs(n*+Math.cos(t*Math.PI/180).toPrecision(10))):t>=180&&t<270?(a[0]=e.x-Math.abs(n*+Math.sin(t*Math.PI/180).toPrecision(10)),a[1]=e.y+Math.abs(n*+Math.cos(t*Math.PI/180).toPrecision(10))):t>=270&&t<=360&&(a[0]=e.x-Math.abs(n*+Math.sin(t*Math.PI/180).toPrecision(10)),a[1]=e.y-Math.abs(n*+Math.cos(t*Math.PI/180).toPrecision(10))),a},t.prototype.createCircles=function(t){for(var e=30;e<t.width;e+=30)this.circles.push({center:{x:t.width/2,y:t.height/2},radius:e})},t.prototype.pathAnimation=function(t,e){var n=this,a=t.angle.start,i=this.prs.animateTime/((t.angle.end-t.angle.start)/this.prs.animateStep),r=setTimeout(function o(){if(a>=t.angle.end)return clearTimeout(r),!1;a+=n.prs.animateStep,a>t.angle.end&&(a=t.angle.end),t.flag=a-t.angle.start<=180?0:1;var s=n.calculateAbsCoord(a,e.center,t.radius);t.settings="M "+e.center.x+","+e.center.y+" L "+t.startPos.x+","+t.startPos.y+" A"+t.radius+","+t.radius+" 0 "+t.flag+", 1 "+s[0]+","+s[1],r=setTimeout(o,i),n.$scope.$digest()},i)},t.prototype.pathClick=function(t,e){t.preventDefault(),console.log("---=== item ===---",e)}}(),function(){angular.module("app").directive("ngR",function(){return function(t,e,n){n.$observe("ngR",function(t){e.attr("r",t)})}}).directive("ngCx",function(){return function(t,e,n){n.$observe("ngCx",function(t){e.attr("cx",t)})}}).directive("ngX",function(){return function(t,e,n){n.$observe("ngX",function(t){e.attr("x",t)})}}).directive("ngY",function(){return function(t,e,n){n.$observe("ngY",function(t){e.attr("y",t)})}}).directive("ngCy",function(){return function(t,e,n){n.$observe("ngCy",function(t){e.attr("cy",t)})}}).directive("ngD",function(){return function(t,e,n){n.$observe("ngD",function(t){e.attr("d",t)})}}).directive("ngFill",function(){return function(t,e,n){n.$observe("ngFill",function(t){e.attr("fill",t)})}})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwibWFpbkN0cmwiLCIkc2NvcGUiLCIkaHR0cCIsImNvbmZpZ0ZhY3RvcnkiLCJ0aGlzIiwiY29uZmlnIiwiaW5pdCIsIiRpbmplY3QiLCJjb250cm9sbGVyIiwicHJvdG90eXBlIiwiX3RoaXMiLCJnZXQiLCJmaXh0dXJlcyIsInRoZW4iLCJyZXNwIiwiY291bnRyaWVzIiwiZGF0YSIsImRhdGFGb3JEaWFncmFtbSIsInNldENvdW50cnkiLCJlIiwiY291bnRyeSIsInByZXZlbnREZWZhdWx0IiwiY29uc29sZSIsImxvZyIsImZhY3RvcnkiLCJwYXRoIiwiY29tcG9uZW50cyIsIndpZHRoIiwiaGVpZ2h0IiwicHJlc2V0cyIsInBhdGhDb2xvcnMiLCIwIiwiMSIsIjIiLCJzdmdXaWR0aCIsInN2Z0hlaWdodCIsInN2Z1N0eWxlcyIsImZpbGwiLCJyYWRpdXMiLCJhbmltYXRlVGltZSIsImFuaW1hdGVTdGVwIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJwYXRoVG9Db21wb25lbnRzIiwib3RoZXJ3aXNlIiwibWFpblZpZXciLCJtYWluIiwidGVtcGxhdGVVcmwiLCJzdGF0ZSIsInVybCIsInZpZXdzIiwibmdEaWFncmFtbUN0cmwiLCIkZWxlbWVudCIsIiRjb21waWxlIiwibmdEZ1ByZXNldHNGYWN0b3J5IiwicHJzIiwiZGlyZWN0aXZlIiwibmdEaWFncmFtbUxpbmsiLCIkYXR0cnMiLCJuZ0RnIiwibGluayIsInNjb3BlIiwiY29udHJvbGxlckFzIiwiYmluZFRvQ29udHJvbGxlciIsInNldHRpbmdzIiwic3R5bGVzIiwicGF0aENsaWNrIiwiY3R4IiwicGF0aGVzIiwiY2lyY2xlcyIsImNlbnRlciIsIngiLCJ5IiwiJHdhdGNoIiwibGVuZ3RoIiwiY3JlYXRlQ2lyY2xlcyIsImFyciIsImFuZ2xlc0FyciIsImtleSIsInB1c2giLCJ2YWx1ZSIsInRleHQiLCJjIiwiaSIsInByaW9yaXR5IiwiaiIsImExIiwiYTIiLCJjdXRSYWRpdXMiLCJfaSIsImNvb3JkcyIsIngxIiwieTEiLCJ4MiIsInkyIiwiX2FyciIsImNhbGN1bGF0ZUFic0Nvb3JkIiwiX2tleSIsIk1hdGgiLCJyb3VuZCIsInRleHRDcmQiLCJ0ZW1wbGF0ZSIsImlkIiwiY29sb3IiLCJzaG93VG9vbHRpcCIsImFuZ2xlIiwic3RhcnQiLCJlbmQiLCJzdGFydFBvcyIsImVuZFBvcyIsInRleHRQb3NpdGlvbiIsInBhdGhBbmltYXRpb24iLCJhYnMiLCJzaW4iLCJQSSIsInRvUHJlY2lzaW9uIiwiY29zIiwiX3NlbGYiLCJjdXJyZW50QW5nbGUiLCJ0aW1lU3RlcCIsInRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiZiIsImNsZWFyVGltZW91dCIsImZsYWciLCJjdXJyZW50Q29vcmRzIiwiJGRpZ2VzdCIsIml0ZW0iLCJlbGVtIiwiYXR0cnMiLCIkb2JzZXJ2ZSIsInIiLCJhdHRyIiwiY3giLCJjeSIsImQiXSwibWFwcGluZ3MiOiJBQUFBLFlBRUFBLFNBQVFDLE9BQU8sT0FBUSxZQUFhLGFBQWMsYUFBYyxjQU9oRSxXQUlDLFFBQVNDLEdBQVNDLEVBQVFDLEVBQU9DLEdBQ2hDQyxLQUFLSCxPQUFTQSxFQUNkRyxLQUFLRixNQUFRQSxFQUNiRSxLQUFLQyxPQUFTRixFQUVkQyxLQUFLRSxPQVJOTixFQUFTTyxTQUFXLFNBQVUsUUFBUyxpQkFDdkNULFFBQVFDLE9BQU8sT0FBT1MsV0FBVyxXQUFZUixHQVU3Q0EsRUFBU1MsVUFBVUgsS0FBTyxXQUN6QixHQUFJSSxHQUFRTixJQUVaQSxNQUFLRixNQUFNUyxJQUFJUCxLQUFLQyxPQUFPTyxTQUFXLGtCQUFrQkMsS0FBSyxTQUFVQyxHQUN0RUosRUFBTUssVUFBWUQsRUFBS0UsS0FDdkJOLEVBQU1PLGdCQUFrQlAsRUFBTUssVUFBVSxNQUkxQ2YsRUFBU1MsVUFBVVMsV0FBYSxTQUFVQyxFQUFHQyxHQUM1Q0QsRUFBRUUsaUJBRUZDLFFBQVFDLElBQUksNEJB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TUFBTyxTQUFVMUQsR0FDL0J3RCxFQUFLSSxLQUFLLElBQUs1RCxRQUdmaEIsVUFBVSxPQUFRLFdBQ3BCLE1BQU8sVUFBVUssRUFBT21FLEVBQU1DLEdBQzdCQSxFQUFNQyxTQUFTLE9BQVEsU0FBVUksR0FDaENOLEVBQUtJLEtBQUssS0FBTUUsUUFHaEI5RSxVQUFVLE1BQU8sV0FDbkIsTUFBTyxVQUFVSyxFQUFPbUUsRUFBTUMsR0FDN0JBLEVBQU1DLFNBQVMsTUFBTyxTQUFVSyxHQUMvQlAsRUFBS0ksS0FBSyxJQUFLRyxRQUdmL0UsVUFBVSxTQUFVLFdBQ3RCLE1BQU8sVUFBVUssRUFBT21FLEVBQU1DLEdBQzdCQSxFQUFNQyxTQUFTLFNBQVUsU0FBVTdGLEdBQ2xDMkYsRUFBS0ksS0FBSyxPQUFRL0YiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgWyduZ0FuaW1hdGUnLCAnbmdNYXRlcmlhbCcsICduZ01lc3NhZ2VzJywgJ3VpLnJvdXRlciddKTtcbi8vbGV0IG1haW5DdHJsID0gcmVxdWlyZSgnLi9jb250cm9sbGVycy9tYWluQ3RybCcpO1xuLy9cbi8vYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ21haW5DdHJsJywgbWFpbkN0cmwpO1xuXCJ1c2Ugc3RyaWN0XCI7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdG1haW5DdHJsLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCBcImNvbmZpZ0ZhY3RvcnlcIl07XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdtYWluQ3RybCcsIG1haW5DdHJsKTtcblxuXHRmdW5jdGlvbiBtYWluQ3RybCgkc2NvcGUsICRodHRwLCBjb25maWdGYWN0b3J5KSB7XG5cdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cdFx0dGhpcy4kaHR0cCA9ICRodHRwO1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnRmFjdG9yeTtcblxuXHRcdHRoaXMuaW5pdCgpO1xuXHR9XG5cblx0bWFpbkN0cmwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdHRoaXMuJGh0dHAuZ2V0KHRoaXMuY29uZmlnLmZpeHR1cmVzICsgJ2NvdW50cmllcy5qc29uJykudGhlbihmdW5jdGlvbiAocmVzcCkge1xuXHRcdFx0X3RoaXMuY291bnRyaWVzID0gcmVzcC5kYXRhO1xuXHRcdFx0X3RoaXMuZGF0YUZvckRpYWdyYW1tID0gX3RoaXMuY291bnRyaWVzWzBdO1xuXHRcdH0pO1xuXHR9O1xuXG5cdG1haW5DdHJsLnByb3RvdHlwZS5zZXRDb3VudHJ5ID0gZnVuY3Rpb24gKGUsIGNvdW50cnkpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnLS0tzp7Ons6ezp4tIGNvdW50cnkgLc6ezp7Ons6eLS0tJywgY291bnRyeSk7XG5cblx0XHR0aGlzLmRhdGFGb3JEaWFncmFtbSA9IGNvdW50cnk7XG5cdH07XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnY29uZmlnRmFjdG9yeScsIGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgcGF0aCA9IHtcblx0XHRcdGZpeHR1cmVzOiAnLi9zcmMvZml4dHVyZXMvJyxcblx0XHRcdGNvbXBvbmVudHM6ICcuL3NyYy9jb21wb25lbnRzLydcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGZpeHR1cmVzOiBwYXRoLmZpeHR1cmVzLFxuXHRcdFx0Y29tcG9uZW50czogcGF0aC5jb21wb25lbnRzXG5cdFx0fTtcblx0fSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnbmdEZ1ByZXNldHNGYWN0b3J5JywgZnVuY3Rpb24gKCkge1xuXHRcdHZhciB3aWR0aCA9IDUwMDtcblx0XHR2YXIgaGVpZ2h0ID0gNTAwO1xuXG5cdFx0dmFyIHByZXNldHMgPSB7XG5cdFx0XHRwYXRoQ29sb3JzOiB7IDA6ICcjZjU4YTQxJywgMTogJyNmMGQzNjcnLCAyOiAnI2U2NGQxYicgfSxcblx0XHRcdHN2Z1dpZHRoOiB3aWR0aCxcblx0XHRcdHN2Z0hlaWdodDogaGVpZ2h0LFxuXHRcdFx0c3ZnU3R5bGVzOiB7XG5cdFx0XHRcdCd3aWR0aCc6IHdpZHRoLFxuXHRcdFx0XHQnaGVpZ2h0JzogaGVpZ2h0LFxuXHRcdFx0XHQnZmlsbCc6ICdibHVlJ1xuXHRcdFx0fSxcblx0XHRcdHJhZGl1czogMTUwLFxuXHRcdFx0YW5pbWF0ZVRpbWU6IDUwMCxcblx0XHRcdGFuaW1hdGVTdGVwOiAxXG5cdFx0fTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHRwYXRoQ29sb3JzOiBwcmVzZXRzLnBhdGhDb2xvcnMsXG5cdFx0XHRzdmdXaWR0aDogcHJlc2V0cy5zdmdXaWR0aCxcblx0XHRcdHN2Z0hlaWdodDogcHJlc2V0cy5zdmdIZWlnaHQsXG5cdFx0XHRzdmdTdHlsZXM6IHByZXNldHMuc3ZnU3R5bGVzLFxuXHRcdFx0cmFkaXVzOiBwcmVzZXRzLnJhZGl1cyxcblx0XHRcdGFuaW1hdGVUaW1lOiBwcmVzZXRzLmFuaW1hdGVUaW1lLFxuXHRcdFx0YW5pbWF0ZVN0ZXA6IHByZXNldHMuYW5pbWF0ZVN0ZXBcblx0XHR9O1xuXHR9KTtcbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbmZpZyhbXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXHRcdHZhciBwYXRoVG9Db21wb25lbnRzID0gJy4vc3JjL2NvbXBvbmVudHMvJztcblxuXHRcdCR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxuXHRcdHZhciBtYWluVmlldyA9IHtcblx0XHRcdFwibWFpblwiOiB7XG5cdFx0XHRcdHRlbXBsYXRlVXJsOiBwYXRoVG9Db21wb25lbnRzICsgJ21haW4vaW5kZXguaHRtbCdcblx0XHRcdFx0Ly90ZW1wbGF0ZVVybDogY29uZmlnRmFjdG9yeS5jb21wb25lbnRzICsgJ2RpYWdyYW1tUGFnZS9kaWFncmFtbVBhZ2UuaHRtbCdcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2hvbWUnLCB7XG5cdFx0XHR1cmw6ICcvJyxcblx0XHRcdHZpZXdzOiBtYWluVmlld1xuXHRcdH0pO1xuXHR9XSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRuZ0RpYWdyYW1tQ3RybC4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkY29tcGlsZVwiLCBcIm5nRGdQcmVzZXRzRmFjdG9yeVwiXTtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ25nRGlhZ3JhbW1DdHJsJywgbmdEaWFncmFtbUN0cmwpO1xuXG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ25nRGlhZ3JhbW0nLCBbXCJjb25maWdGYWN0b3J5XCIsIGZ1bmN0aW9uIChjb25maWdGYWN0b3J5KSB7XG5cdFx0dmFyIG5nRGcgPSAnbmdEaWFncmFtbSc7XG5cblx0XHRmdW5jdGlvbiBuZ0RpYWdyYW1tTGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHt9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0bGluazogbmdEaWFncmFtbUxpbmssXG5cdFx0XHRzY29wZToge30sXG5cdFx0XHR0ZW1wbGF0ZVVybDogY29uZmlnRmFjdG9yeS5jb21wb25lbnRzICsgbmdEZyArICcvJyArIG5nRGcgKyAnLmh0bWwnLFxuXHRcdFx0Y29udHJvbGxlcjogbmdEaWFncmFtbUN0cmwsXG5cdFx0XHRjb250cm9sbGVyQXM6ICdkZycsXG5cdFx0XHRiaW5kVG9Db250cm9sbGVyOiB7XG5cdFx0XHRcdHNldHRpbmdzOiAnPT8nLFxuXHRcdFx0XHRkYXRhOiAnPT8nLFxuXHRcdFx0XHRzdHlsZXM6ICc9PycsXG5cdFx0XHRcdHBhdGhDbGljazogJz0/Jyxcblx0XHRcdFx0Y3R4OiAnPT8nXG5cdFx0XHR9XG5cdFx0fTtcblx0fV0pO1xuXG5cdGZ1bmN0aW9uIG5nRGlhZ3JhbW1DdHJsKCRzY29wZSwgJGVsZW1lbnQsICRjb21waWxlLCBuZ0RnUHJlc2V0c0ZhY3RvcnkpIHtcblx0XHR0aGlzLiRzY29wZSA9ICRzY29wZTtcblx0XHR0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XG5cdFx0dGhpcy4kY29tcGlsZSA9ICRjb21waWxlO1xuXHRcdC8qKlxuICAgKiDQlNC10YTQvtC70YLQvdGL0LUg0L3QsNGB0YLRgNC+0LnQutC4INC00LvRjyDQtNC40YDQtdC60YLQuNCy0LrQuFxuICAgKi9cblx0XHR0aGlzLnBycyA9IG5nRGdQcmVzZXRzRmFjdG9yeTtcblxuXHRcdHRoaXMuaW5pdCgpO1xuXHR9XG5cblx0LyoqXG4gICog0KHRgtCw0YDRgtGD0LXQvFxuICAqL1xuXHRuZ0RpYWdyYW1tQ3RybC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXG5cdFx0LyoqXG4gICAqINCc0LDRgdGB0LjQsiDRgtGN0LPQviA8Zz4sINC60L7RgtC+0YDRi9C5INGA0LXQvdC00LXRgNC40YLRgdGPINCyINGC0LXQvNC/0LvQtdC50YLQtVxuICAgKi9cblx0XHR0aGlzLnBhdGhlcyA9IFtdO1xuXG5cdFx0LyoqXG4gICAqINCc0LDRgdGB0LjQsiDRgtGN0LPQviA8Y2lyY2xlPlxuICAgKi9cblx0XHR0aGlzLmNpcmNsZXMgPSBbXTtcblxuXHRcdHZhciBjb25maWcgPSB7XG5cdFx0XHR3aWR0aDogdGhpcy5wcnMuc3ZnV2lkdGgsXG5cdFx0XHRoZWlnaHQ6IHRoaXMucHJzLnN2Z0hlaWdodCxcblx0XHRcdHJhZGl1czogdGhpcy5wcnMucmFkaXVzLFxuXHRcdFx0Y2VudGVyOiB7IHg6IHRoaXMucHJzLnN2Z1dpZHRoIC8gMiwgeTogdGhpcy5wcnMuc3ZnSGVpZ2h0IC8gMiB9XG5cdFx0fTtcblxuXHRcdHRoaXMuJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gX3RoaXMuZGF0YTtcblx0XHR9LCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0aWYgKGRhdGEpIHtcblx0XHRcdFx0Ly9UT0RPOiDQndCw0L/QuNGB0LDRgtGMINC/0YDQvtCy0LXRgNC60YMg0L3QsCDRgdGD0LzQvNGDINC/0YDQvtGG0LXQvdGC0L7QslxuXG5cdFx0XHRcdGlmIChfdGhpcy5wYXRoZXMgJiYgX3RoaXMucGF0aGVzLmxlbmd0aCkgX3RoaXMucGF0aGVzLmxlbmd0aCA9IDA7XG5cdFx0XHRcdGNvbmZpZy5yYWRpdXMgPSBfdGhpcy5wcnMucmFkaXVzO1xuXG5cdFx0XHRcdGlmICghX3RoaXMuY2lyY2xlcy5sZW5ndGgpIF90aGlzLmNyZWF0ZUNpcmNsZXMoY29uZmlnKTtcblxuXHRcdFx0XHR2YXIgYXJyID0gW10sXG5cdFx0XHRcdCAgICBhbmdsZXNBcnIgPSBbXTtcblxuXHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gZGF0YS5kYXRhKSB7XG5cdFx0XHRcdFx0YXJyLnB1c2goe1xuXHRcdFx0XHRcdFx0dmFsdWU6IGRhdGEuZGF0YVtrZXldLnZhbHVlLFxuXHRcdFx0XHRcdFx0dGV4dDogZGF0YS5kYXRhW2tleV0udGV4dFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICog0KHQvtC30LTQsNC10Lwg0YHQtdC60YLQvtGA0LAuINCf0YDQvtGG0LXQvdGC0Ysg0L/QtdGA0LXQstC+0LTQuNC8INCyINGA0LDQtNC40LDQvdGLXG4gICAgICogYTEgLSDQvdCw0YfQsNC70L4g0YHQtdC60YLQvtGA0LAsINCwMiA9INC60L7QvdC10YYg0YHQtdC60YLQvtGA0LBcbiAgICAgKi9cblx0XHRcdFx0Zm9yICh2YXIgYyA9IDAsIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdFx0dmFyIHByaW9yaXR5ID0gMDtcblx0XHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGFyci5sZW5ndGg7IGogKz0gMSkge1xuXHRcdFx0XHRcdFx0aWYgKGFycltpXS52YWx1ZSA8IGFycltqXS52YWx1ZSkgcHJpb3JpdHkgKz0gMTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YW5nbGVzQXJyLnB1c2goeyBhMTogYyAqIDMuNiwgYTI6IChjICsgYXJyW2ldLnZhbHVlKSAqIDMuNiwgdGV4dDogYXJyW2ldLnRleHQsIHZhbHVlOiBhcnJbaV0udmFsdWUsIGN1dFJhZGl1czogcHJpb3JpdHkgfSk7IC8vINCf0LXRgNC10LLQvtC00LjQvCDQs9GA0LDQtNGD0YHRiyDQsiDQs9GA0LDQtNC40LXQvdGC0Ytcblx0XHRcdFx0XHRjICs9IGFycltpXS52YWx1ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZvciAodmFyIF9pID0gMDsgX2kgPCBhbmdsZXNBcnIubGVuZ3RoOyBfaSArPSAxKSB7XG5cdFx0XHRcdFx0dmFyIGNvb3JkcyA9IHsgeDE6ICcnLCB5MTogJycsIHgyOiAnJywgeTI6ICcnIH07XG5cblx0XHRcdFx0XHR2YXIgX2FyciA9IF90aGlzLmNhbGN1bGF0ZUFic0Nvb3JkKGFuZ2xlc0FycltfaV0uYTEsIGNvbmZpZy5jZW50ZXIsIGNvbmZpZy5yYWRpdXMgLSBhbmdsZXNBcnJbX2ldLmN1dFJhZGl1cyAqIDIwKTtcblx0XHRcdFx0XHRjb29yZHMueDEgPSBfYXJyWzBdO1xuXHRcdFx0XHRcdGNvb3Jkcy55MSA9IF9hcnJbMV07XG5cblx0XHRcdFx0XHRfYXJyID0gX3RoaXMuY2FsY3VsYXRlQWJzQ29vcmQoYW5nbGVzQXJyW19pXS5hMiwgY29uZmlnLmNlbnRlciwgY29uZmlnLnJhZGl1cyAtIGFuZ2xlc0FycltfaV0uY3V0UmFkaXVzICogMjApO1xuXHRcdFx0XHRcdGNvb3Jkcy54MiA9IF9hcnJbMF07XG5cdFx0XHRcdFx0Y29vcmRzLnkyID0gX2FyclsxXTtcblxuXHRcdFx0XHRcdGZvciAodmFyIF9rZXkgaW4gY29vcmRzKSB7XG5cdFx0XHRcdFx0XHRjb29yZHNbX2tleV0gPSBNYXRoLnJvdW5kKGNvb3Jkc1tfa2V5XSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqINCh0LLQvtC50YHRgtCy0L4sINC60L7RgtC+0YDQvtC1INC60L7RgNC80LjQvCDQvdCwINCy0YzRjtGF0YMg0LTQu9GPINC+0YLRgNC40YHQvtCy0LrQuCDRgdC10LrRgtC+0YDQsFxuICAgICAgKi9cblx0XHRcdFx0XHR2YXIgdGV4dENyZCA9IF90aGlzLmNhbGN1bGF0ZUFic0Nvb3JkKChhbmdsZXNBcnJbX2ldLmExICsgYW5nbGVzQXJyW19pXS5hMikgLyAyLCBjb25maWcuY2VudGVyLCAoY29uZmlnLnJhZGl1cyAtIF9pICogMjApIC8gMik7XG5cblx0XHRcdFx0XHR2YXIgdGVtcGxhdGUgPSB7XG5cdFx0XHRcdFx0XHRpZDogJ2dfJyArIChfaSArIDEpLFxuXHRcdFx0XHRcdFx0Y29sb3I6IF90aGlzLnBycy5wYXRoQ29sb3JzW2FuZ2xlc0FycltfaV0uY3V0UmFkaXVzXSxcblx0XHRcdFx0XHRcdHZhbHVlOiBhbmdsZXNBcnJbX2ldLnZhbHVlLFxuXHRcdFx0XHRcdFx0dGV4dDogYW5nbGVzQXJyW19pXS50ZXh0LFxuXHRcdFx0XHRcdFx0cmFkaXVzOiBjb25maWcucmFkaXVzIC0gYW5nbGVzQXJyW19pXS5jdXRSYWRpdXMgKiAyMCxcblx0XHRcdFx0XHRcdHNob3dUb29sdGlwOiBhbmdsZXNBcnJbX2ldLmEyIC0gYW5nbGVzQXJyW19pXS5hMSA+IDE1LFxuXHRcdFx0XHRcdFx0YW5nbGU6IHtcblx0XHRcdFx0XHRcdFx0c3RhcnQ6IGFuZ2xlc0FycltfaV0uYTEsXG5cdFx0XHRcdFx0XHRcdGVuZDogYW5nbGVzQXJyW19pXS5hMlxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdHN0YXJ0UG9zOiB7XG5cdFx0XHRcdFx0XHRcdHg6IGNvb3Jkcy54MSxcblx0XHRcdFx0XHRcdFx0eTogY29vcmRzLnkxXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0ZW5kUG9zOiB7XG5cdFx0XHRcdFx0XHRcdHg6IGNvb3Jkcy54Mixcblx0XHRcdFx0XHRcdFx0eTogY29vcmRzLnkyXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0dGV4dFBvc2l0aW9uOiB7XG5cdFx0XHRcdFx0XHRcdHg6IHRleHRDcmRbMF0sXG5cdFx0XHRcdFx0XHRcdHk6IHRleHRDcmRbMV1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0X3RoaXMucGF0aGVzLnB1c2godGVtcGxhdGUpO1xuXG5cdFx0XHRcdFx0X3RoaXMucGF0aEFuaW1hdGlvbihfdGhpcy5wYXRoZXNbX2ldLCBjb25maWcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cblx0LyoqXG4gICog0KTRg9C90LrRhtC40Y8g0LLQvtC30LLRgNCw0YnQsNC10YIg0LzQsNGB0YHQuNCyINC40Lcg0LTQstGD0YUg0YfQuNGB0LXQuyAo0LrQvtC+0YDQtNC40L3QsNGC0YsgeCDQuCDRgylcbiAgKiDQmtC+0L7RgNC00LjQvdCw0YLRiyDRgNCw0YHRgdGH0LjRgtGL0LLQsNGO0YLRgdGPINC00LvRjyDQvtC/0YDQtdC00LXQu9GR0L3QvdC+0LPQviDRg9Cz0LvQsCDQvtGC0L3QvtGB0LjRgtC10LvRjNC90L4g0YbQtdC90YLRgNCwINC00LjQsNCz0YDQsNC80LzRiy5cbiAgKiDQo9GH0LjRgtGL0LLQsNC10Lwg0YDQsNC00LjRg9GBXG4gICovXG5cdG5nRGlhZ3JhbW1DdHJsLnByb3RvdHlwZS5jYWxjdWxhdGVBYnNDb29yZCA9IGZ1bmN0aW9uIChhbmdsZSwgY2VudGVyLCByYWRpdXMpIHtcblx0XHR2YXIgYXJyID0gW107XG5cdFx0aWYgKGFuZ2xlID49IDAgJiYgYW5nbGUgPCA5MCkge1xuXHRcdFx0YXJyWzBdID0gY2VudGVyLnggKyBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5zaW4oYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdFx0YXJyWzFdID0gY2VudGVyLnkgLSBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5jb3MoYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdH0gZWxzZSBpZiAoYW5nbGUgPj0gOTAgJiYgYW5nbGUgPCAxODApIHtcblx0XHRcdGFyclswXSA9IGNlbnRlci54ICsgTWF0aC5hYnMocmFkaXVzICogK01hdGguc2luKGFuZ2xlICogTWF0aC5QSSAvIDE4MCkudG9QcmVjaXNpb24oMTApKTtcblx0XHRcdGFyclsxXSA9IGNlbnRlci55ICsgTWF0aC5hYnMocmFkaXVzICogK01hdGguY29zKGFuZ2xlICogTWF0aC5QSSAvIDE4MCkudG9QcmVjaXNpb24oMTApKTtcblx0XHR9IGVsc2UgaWYgKGFuZ2xlID49IDE4MCAmJiBhbmdsZSA8IDI3MCkge1xuXHRcdFx0YXJyWzBdID0gY2VudGVyLnggLSBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5zaW4oYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdFx0YXJyWzFdID0gY2VudGVyLnkgKyBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5jb3MoYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdH0gZWxzZSBpZiAoYW5nbGUgPj0gMjcwICYmIGFuZ2xlIDw9IDM2MCkge1xuXHRcdFx0YXJyWzBdID0gY2VudGVyLnggLSBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5zaW4oYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdFx0YXJyWzFdID0gY2VudGVyLnkgLSBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5jb3MoYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdH1cblx0XHRyZXR1cm4gYXJyO1xuXHR9O1xuXG5cdC8qKlxuICAqINCh0L7Qt9C00LDQtdC8INC80LDRgdGB0LjQsiDQv9GD0L3QutGC0LjRgNC90YvRhSDQutC+0LvQtdGGXG4gICovXG5cdG5nRGlhZ3JhbW1DdHJsLnByb3RvdHlwZS5jcmVhdGVDaXJjbGVzID0gZnVuY3Rpb24gKGNvbmZpZykge1xuXHRcdGZvciAodmFyIGkgPSAzMDsgaSA8IGNvbmZpZy53aWR0aDsgaSArPSAzMCkge1xuXHRcdFx0dGhpcy5jaXJjbGVzLnB1c2goe1xuXHRcdFx0XHRjZW50ZXI6IHtcblx0XHRcdFx0XHR4OiBjb25maWcud2lkdGggLyAyLFxuXHRcdFx0XHRcdHk6IGNvbmZpZy5oZWlnaHQgLyAyXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHJhZGl1czogaVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXG5cdC8qKlxuICAqINCk0YPQvdC60YbQuNGPINCw0L3QuNC80LDRhtC40LhcbiAgKi9cblx0bmdEaWFncmFtbUN0cmwucHJvdG90eXBlLnBhdGhBbmltYXRpb24gPSBmdW5jdGlvbiAocGF0aCwgY29uZmlnKSB7XG5cdFx0dmFyIF9zZWxmID0gdGhpcztcblx0XHR2YXIgY3VycmVudEFuZ2xlID0gcGF0aC5hbmdsZS5zdGFydDtcblx0XHR2YXIgdGltZVN0ZXAgPSB0aGlzLnBycy5hbmltYXRlVGltZSAvICgocGF0aC5hbmdsZS5lbmQgLSBwYXRoLmFuZ2xlLnN0YXJ0KSAvIHRoaXMucHJzLmFuaW1hdGVTdGVwKTtcblxuXHRcdHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiBmKCkge1xuXHRcdFx0aWYgKGN1cnJlbnRBbmdsZSA+PSBwYXRoLmFuZ2xlLmVuZCkge1xuXHRcdFx0XHRjbGVhclRpbWVvdXQodGltZW91dCk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiDQodC80LXRidCw0LXQvCDRgdC10LrRgtC+0YAg0L3QsCDQt9Cw0LTQsNC90YvQuSDRiNCw0LMg0Lgg0L/RgNC+0LLQtdGA0Y/QtdC8LCDRh9GC0L7QsdGLINGD0LPQvtC7INC90LUg0L/RgNC10LLRi9GI0LDQuyDQt9C90LDRh9C10L3QuNC1INGD0LPQu9CwINC/0YDQsNCy0L7Qs9C+INC60YDQsNGPINGB0LXQutGC0L7RgNCwXG4gICAgKi9cblx0XHRcdGN1cnJlbnRBbmdsZSArPSBfc2VsZi5wcnMuYW5pbWF0ZVN0ZXA7XG5cdFx0XHRpZiAoY3VycmVudEFuZ2xlID4gcGF0aC5hbmdsZS5lbmQpIGN1cnJlbnRBbmdsZSA9IHBhdGguYW5nbGUuZW5kO1xuXG5cdFx0XHQvKipcbiAgICAqINCh0LzQvtGC0YDQuNC8LCDQutCw0LrRg9GOINGH0LDRgdGC0Ywg0LTRg9Cz0Lgg0L7RgtGA0LjRgdC+0LLRi9Cy0LDRgtGMLiDQldGB0LvQuCDQtNGD0LPQsCDQvNC10L3RjNGI0LUgMTgwINCz0YDQsNC00YPRgdC+0LIgLSDRgdGC0LDQstC40Lwg0YTQu9Cw0LMg0L3QsCDQvtGC0YDQuNGB0L7QstC60YMg0LzQtdC90YzRiNC10Lkg0YHRgtC+0YDQvtC90YtcbiAgICAqL1xuXHRcdFx0cGF0aC5mbGFnID0gY3VycmVudEFuZ2xlIC0gcGF0aC5hbmdsZS5zdGFydCA8PSAxODAgPyAwIDogMTtcblxuXHRcdFx0LyoqXG4gICAgKiDQotC10LrRg9GJ0LDRjyDQutC+0L7RgNC00LjQvdCw0YLQsCDRgdC80LXRidC10L3QuNGPINC00YPQs9C4XG4gICAgKi9cblx0XHRcdHZhciBjdXJyZW50Q29vcmRzID0gX3NlbGYuY2FsY3VsYXRlQWJzQ29vcmQoY3VycmVudEFuZ2xlLCBjb25maWcuY2VudGVyLCBwYXRoLnJhZGl1cyk7XG5cdFx0XHRwYXRoLnNldHRpbmdzID0gJ00gJyArIGNvbmZpZy5jZW50ZXIueCArICcsJyArIGNvbmZpZy5jZW50ZXIueSArICcgTCAnICsgJycgKyBwYXRoLnN0YXJ0UG9zLnggKyAnLCcgKyBwYXRoLnN0YXJ0UG9zLnkgKyAnIEEnICsgJycgKyBwYXRoLnJhZGl1cyArICcsJyArIHBhdGgucmFkaXVzICsgJyAwICcgKyAnJyArIHBhdGguZmxhZyArICcsIDEgJyArIGN1cnJlbnRDb29yZHNbMF0gKyAnLCcgKyBjdXJyZW50Q29vcmRzWzFdICsgJyc7XG5cblx0XHRcdC8qKlxuICAgICog0KDQtdC60YPRgNGB0LjQvCDRgtCw0LnQvNCw0YPRglxuICAgICovXG5cdFx0XHR0aW1lb3V0ID0gc2V0VGltZW91dChmLCB0aW1lU3RlcCk7XG5cblx0XHRcdC8qKlxuICAgICog0J7QsdC90L7QstC70Y/QtdC8INCy0YzRjtGF0YNcbiAgICAqL1xuXHRcdFx0X3NlbGYuJHNjb3BlLiRkaWdlc3QoKTtcblx0XHR9LCB0aW1lU3RlcCk7XG5cdH07XG5cblx0LyoqXG4gICog0JrQvtC70LvQsdC10Log0LrQu9C40LrQsFxuICAqL1xuXHRuZ0RpYWdyYW1tQ3RybC5wcm90b3R5cGUucGF0aENsaWNrID0gZnVuY3Rpb24gKGUsIGl0ZW0pIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Y29uc29sZS5sb2coJy0tLT09PSBpdGVtID09PS0tLScsIGl0ZW0pO1xuXHR9O1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZSgnbmdSJywgZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG5cdFx0XHRhdHRycy4kb2JzZXJ2ZSgnbmdSJywgZnVuY3Rpb24gKHIpIHtcblx0XHRcdFx0ZWxlbS5hdHRyKCdyJywgcik7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KS5kaXJlY3RpdmUoJ25nQ3gnLCBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbSwgYXR0cnMpIHtcblx0XHRcdGF0dHJzLiRvYnNlcnZlKCduZ0N4JywgZnVuY3Rpb24gKGN4KSB7XG5cdFx0XHRcdGVsZW0uYXR0cignY3gnLCBjeCk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KS5kaXJlY3RpdmUoJ25nWCcsIGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24gKHNjb3BlLCBlbGVtLCBhdHRycykge1xuXHRcdFx0YXR0cnMuJG9ic2VydmUoJ25nWCcsIGZ1bmN0aW9uICh4KSB7XG5cdFx0XHRcdGVsZW0uYXR0cigneCcsIHgpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSkuZGlyZWN0aXZlKCduZ1knLCBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbSwgYXR0cnMpIHtcblx0XHRcdGF0dHJzLiRvYnNlcnZlKCduZ1knLCBmdW5jdGlvbiAoeSkge1xuXHRcdFx0XHRlbGVtLmF0dHIoJ3knLCB5KTtcblx0XHRcdH0pO1xuXHRcdH07XG5cdH0pLmRpcmVjdGl2ZSgnbmdDeScsIGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24gKHNjb3BlLCBlbGVtLCBhdHRycykge1xuXHRcdFx0YXR0cnMuJG9ic2VydmUoJ25nQ3knLCBmdW5jdGlvbiAoY3kpIHtcblx0XHRcdFx0ZWxlbS5hdHRyKCdjeScsIGN5KTtcblx0XHRcdH0pO1xuXHRcdH07XG5cdH0pLmRpcmVjdGl2ZSgnbmdEJywgZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG5cdFx0XHRhdHRycy4kb2JzZXJ2ZSgnbmdEJywgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0ZWxlbS5hdHRyKCdkJywgZCk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KS5kaXJlY3RpdmUoJ25nRmlsbCcsIGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24gKHNjb3BlLCBlbGVtLCBhdHRycykge1xuXHRcdFx0YXR0cnMuJG9ic2VydmUoJ25nRmlsbCcsIGZ1bmN0aW9uIChmaWxsKSB7XG5cdFx0XHRcdGVsZW0uYXR0cignZmlsbCcsIGZpbGwpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSk7XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
