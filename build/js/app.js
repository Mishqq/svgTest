"use strict";angular.module("app",["ngAnimate","ngMaterial","ngMessages","ui.router"]),function(){function t(t,i,e){this.$scope=t,this.$http=i,this.config=e,this.dgConfig={width:300,height:300,radius:110,stepRadius:15},this.init()}t.$inject=["$scope","$http","configFactory"],angular.module("app").controller("mainCtrl",t),t.prototype.init=function(){var t=this;this.$http.get(this.config.fixtures+"countries.json").then(function(i){t.countries=i.data,t.cNum=0}),this.$http.get(this.config.fixtures+"otherinfo.json").then(function(i){t.info2=i.data,t.iNum=0})},t.prototype.setCountry=function(t,i){t.preventDefault(),this.cNum=i},t.prototype.setInfo2Item=function(t,i){t.preventDefault(),this.iNum=i},t.prototype.callbackClick=function(t){console.log("---=== item ===---",t)}}(),function(){angular.module("app").factory("configFactory",function(){var t={fixtures:"./src/fixtures/",components:"./src/components/"};return{fixtures:t.fixtures,components:t.components}})}(),function(){angular.module("app").factory("ngDgPresetsFactory",function(){var t=500,i=500,e={pathColors:{0:"#f58a41",1:"#f0d367",2:"#e64d1b"},svgWidth:t,svgHeight:i,svgStyles:{width:t,height:i,fill:"blue"},radius:155,animateTime:500,animateStep:1,sRadius:30};return{pathColors:e.pathColors,svgWidth:e.svgWidth,svgHeight:e.svgHeight,svgStyles:e.svgStyles,radius:e.radius,animateTime:e.animateTime,animateStep:e.animateStep,sRadius:e.sRadius}})}(),function(){angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,i){var e="./src/components/";i.otherwise("/");var n={main:{templateUrl:e+"main/index.html"}};t.state("home",{url:"/",views:n})}])}(),function(){function t(t,i){var e=this;this.$scope=t,this.pathClick||(this.pathClick=function(){console.log("Коллбек по клику не задан")}),this.prs=i,this.init(),setTimeout(function(){e.paramWatcher()},1500)}t.$inject=["$scope","ngDgPresetsFactory"],angular.module("app").controller("ngDiagrammCtrl",t),angular.module("app").directive("ngDiagramm",["configFactory",function(i){function e(t,i,e){}var n="ngDiagramm";return{link:e,scope:{},templateUrl:i.components+n+"/"+n+".html",controller:t,controllerAs:"dg",bindToController:{data:"=?",styles:"=?",width:"@?",height:"@?",radius:"@?",stepRadius:"@?",pathClickCb:"=?",ctx:"=?",name:"@?"}}}]),t.prototype.init=function(){var t=this;this.pathes=[],this.circles=[];var i={width:+this.width||this.prs.svgWidth,height:+this.height||this.prs.svgHeight,radius:+this.radius||this.prs.radius,sRadius:+this.stepRadius||this.prs.sRadius,center:{x:(+this.width||this.prs.svgWidth)/2,y:(+this.height||this.prs.svgHeight)/2}};this.$scope.$watch(function(){return t.data},function(e){if(e){t.pathes&&t.pathes.length&&(t.pathes.length=0),t.circles.length||t.createCircles(i);var n=[],a=[];for(var s in e.data)n.push({value:e.data[s].value,text:e.data[s].text});for(var o=0,r=0;r<n.length;r+=1){for(var u=0,c=0;c<n.length;c+=1)n[r].value<n[c].value&&(u+=1);a.push({a1:3.6*o,a2:3.6*(o+n[r].value),text:n[r].text,value:n[r].value,sRadius:u}),o+=n[r].value}for(var h=0;h<a.length;h+=1){var l={x1:"",y1:"",x2:"",y2:""},p=t.calculateAbsCoord(a[h].a1,i.center,i.radius-a[h].sRadius*i.sRadius);l.x1=p[0],l.y1=p[1],p=t.calculateAbsCoord(a[h].a2,i.center,i.radius-a[h].sRadius*i.sRadius),l.x2=p[0],l.y2=p[1];for(var d in l)l[d]=Math.round(l[d]);var f=t.calculateAbsCoord((a[h].a1+a[h].a2)/2,i.center,(i.radius-h*i.sRadius)/2),g={id:"g_"+(h+1),color:t.prs.pathColors[a[h].sRadius],value:a[h].value,text:a[h].text,radius:i.radius-a[h].sRadius*i.sRadius,showTooltip:!1,angle:{start:a[h].a1,end:a[h].a2},startPos:{x:l.x1,y:l.y1},endPos:{x:l.x2,y:l.y2},textPosition:{x:f[0],y:f[1]}};t.pathes.push(g),t.pathAnimation(t.pathes[h],i)}}})},t.prototype.calculateAbsCoord=function(t,i,e){var n=[];return t>=0&&t<90?(n[0]=i.x+Math.abs(e*+Math.sin(t*Math.PI/180).toPrecision(10)),n[1]=i.y-Math.abs(e*+Math.cos(t*Math.PI/180).toPrecision(10))):t>=90&&t<180?(n[0]=i.x+Math.abs(e*+Math.sin(t*Math.PI/180).toPrecision(10)),n[1]=i.y+Math.abs(e*+Math.cos(t*Math.PI/180).toPrecision(10))):t>=180&&t<270?(n[0]=i.x-Math.abs(e*+Math.sin(t*Math.PI/180).toPrecision(10)),n[1]=i.y+Math.abs(e*+Math.cos(t*Math.PI/180).toPrecision(10))):t>=270&&t<=360&&(n[0]=i.x-Math.abs(e*+Math.sin(t*Math.PI/180).toPrecision(10)),n[1]=i.y-Math.abs(e*+Math.cos(t*Math.PI/180).toPrecision(10))),n},t.prototype.createCircles=function(t){for(var i=t.sRadius;i<t.width;i+=t.sRadius)this.circles.push({center:{x:t.width/2,y:t.height/2},radius:i})},t.prototype.pathAnimation=function(t,i){var e=this,n=t.angle.start,a=this.prs.animateTime/((t.angle.end-t.angle.start)/this.prs.animateStep);setTimeout(function(){t.showTooltip=t.angle.end-t.angle.start>15},500);var s=setTimeout(function o(){if(n>=t.angle.end)return clearTimeout(s),!1;n+=e.prs.animateStep,n>t.angle.end&&(n=t.angle.end),t.flag=n-t.angle.start<=180?0:1;var r=e.calculateAbsCoord(n,i.center,t.radius);t.settings="M "+i.center.x+","+i.center.y+" L "+t.startPos.x+","+t.startPos.y+" A"+t.radius+","+t.radius+" 0 "+t.flag+", 1 "+r[0]+","+r[1],s=setTimeout(o,a),e.$scope.$digest()},a)},t.prototype.pathClick=function(t,i){t.preventDefault(),this.pathClickCb.call(this.ctx,i)},t.prototype.paramWatcher=function(){var t=this,i=!1,e=1e3;this.$scope.$watch(function(){return t.width},function(n){i=!1,setTimeout(function(){i=!0,t.$scope.$digest()},e)}),this.$scope.$watch(function(){return t.height},function(n){i=!1,setTimeout(function(){i=!0,t.$scope.$digest()},e)}),this.$scope.$watch(function(){return t.radius},function(n){i=!1,setTimeout(function(){i=!0,t.$scope.$digest()},e)}),this.$scope.$watch(function(){return t.stepRadius},function(n){i=!1,setTimeout(function(){i=!0,t.$scope.$digest()},e)}),this.$scope.$watch(function(){return i},function(i){i&&t.init()})}}(),function(){angular.module("app").directive("ngR",function(){return function(t,i,e){e.$observe("ngR",function(t){i.attr("r",t)})}}).directive("ngCx",function(){return function(t,i,e){e.$observe("ngCx",function(t){i.attr("cx",t)})}}).directive("ngX",function(){return function(t,i,e){e.$observe("ngX",function(t){i.attr("x",t)})}}).directive("ngY",function(){return function(t,i,e){e.$observe("ngY",function(t){i.attr("y",t)})}}).directive("ngCy",function(){return function(t,i,e){e.$observe("ngCy",function(t){i.attr("cy",t)})}}).directive("ngD",function(){return function(t,i,e){e.$observe("ngD",function(t){i.attr("d",t)})}}).directive("ngFill",function(){return function(t,i,e){e.$observe("ngFill",function(t){i.attr("fill",t)})}})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwibWFpbkN0cmwiLCIkc2NvcGUiLCIkaHR0cCIsImNvbmZpZ0ZhY3RvcnkiLCJ0aGlzIiwiY29uZmlnIiwiZGdDb25maWciLCJ3aWR0aCIsImhlaWdodCIsInJhZGl1cyIsInN0ZXBSYWRpdXMiLCJpbml0IiwiJGluamVjdCIsImNvbnRyb2xsZXIiLCJwcm90b3R5cGUiLCJfdGhpcyIsImdldCIsImZpeHR1cmVzIiwidGhlbiIsInJlc3AiLCJjb3VudHJpZXMiLCJkYXRhIiwiY051bSIsImluZm8yIiwiaU51bSIsInNldENvdW50cnkiLCJlIiwiaWR4IiwicHJldmVudERlZmF1bHQiLCJzZXRJbmZvMkl0ZW0iLCJjYWxsYmFja0NsaWNrIiwiaXRlbSIsImNvbnNvbGUiLCJsb2ciLCJmYWN0b3J5IiwicGF0aCIsImNvbXBvbmVudHMiLCJwcmVzZXRzIiwicGF0aENvbG9ycyIsIjAiLCIxIiwiMiIsInN2Z1dpZHRoIiwic3ZnSGVpZ2h0Iiwic3ZnU3R5bGVzIiwiZmlsbCIsImFuaW1hdGVUaW1lIiwiYW5pbWF0ZVN0ZXAiLCJzUmFkaXVzIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJwYXRoVG9Db21wb25lbnRzIiwib3RoZXJ3aXNlIiwibWFpblZpZXciLCJtYWluIiwidGVtcGxhdGVVcmwiLCJzdGF0ZSIsInVybCIsInZpZXdzIiwibmdEaWFncmFtbUN0cmwiLCJuZ0RnUHJlc2V0c0ZhY3RvcnkiLCJwYXRoQ2xpY2siLCJwcnMiLCJzZXRUaW1lb3V0IiwicGFyYW1XYXRjaGVyIiwiZGlyZWN0aXZlIiwibmdEaWFncmFtbUxpbmsiLCIkZWxlbWVudCIsIiRhdHRycyIsIm5nRGciLCJsaW5rIiwic2NvcGUiLCJjb250cm9sbGVyQXMiLCJiaW5kVG9Db250cm9sbGVyIiwic3R5bGVzIiwicGF0aENsaWNrQ2IiLCJjdHgiLCJuYW1lIiwiX3RoaXMyIiwicGF0aGVzIiwiY2lyY2xlcyIsImNlbnRlciIsIngiLCJ5IiwiJHdhdGNoIiwibGVuZ3RoIiwiY3JlYXRlQ2lyY2xlcyIsImFyciIsImFuZ2xlc0FyciIsImtleSIsInB1c2giLCJ2YWx1ZSIsInRleHQiLCJjIiwiaSIsInByaW9yaXR5IiwiaiIsImExIiwiYTIiLCJfaSIsImNvb3JkcyIsIngxIiwieTEiLCJ4MiIsInkyIiwiX2FyciIsImNhbGN1bGF0ZUFic0Nvb3JkIiwiX2tleSIsIk1hdGgiLCJyb3VuZCIsInRleHRDcmQiLCJ0ZW1wbGF0ZSIsImlkIiwiY29sb3IiLCJzaG93VG9vbHRpcCIsImFuZ2xlIiwic3RhcnQiLCJlbmQiLCJzdGFydFBvcyIsImVuZFBvcyIsInRleHRQb3NpdGlvbiIsInBhdGhBbmltYXRpb24iLCJhYnMiLCJzaW4iLCJQSSIsInRvUHJlY2lzaW9uIiwiY29zIiwiX3NlbGYiLCJjdXJyZW50QW5nbGUiLCJ0aW1lU3RlcCIsInRpbWVvdXQiLCJmIiwiY2xlYXJUaW1lb3V0IiwiZmxhZyIsImN1cnJlbnRDb29yZHMiLCJzZXR0aW5ncyIsIiRkaWdlc3QiLCJjYWxsIiwiX3RoaXMzIiwiZGVmZW5kIiwiZGVmVGltZSIsImRlZiIsImVsZW0iLCJhdHRycyIsIiRvYnNlcnZlIiwiciIsImF0dHIiLCJjeCIsImN5IiwiZCJdLCJtYXBwaW5ncyI6IkFBQUEsWUFFQUEsU0FBUUMsT0FBTyxPQUFRLFlBQWEsYUFBYyxhQUFjLGNBT2hFLFdBSUMsUUFBU0MsR0FBU0MsRUFBUUMsRUFBT0MsR0FDaENDLEtBQUtILE9BQVNBLEVBQ2RHLEtBQUtGLE1BQVFBLEVBQ2JFLEtBQUtDLE9BQVNGLEVBRWRDLEtBQUtFLFVBQ0pDLE1BQU8sSUFDUEMsT0FBUSxJQUNSQyxPQUFRLElBQ1JDLFdBQVksSUFHYk4sS0FBS08sT0FmTlgsRUFBU1ksU0FBVyxTQUFVLFFBQVMsaUJBQ3ZDZCxRQUFRQyxPQUFPLE9BQU9jLFdBQVcsV0FBWWIsR0FpQjdDQSxFQUFTYyxVQUFVSCxLQUFPLFdBQ3pCLEdBQUlJLEdBQVFYLElB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LGFBTW5CLFdBQ0NiLFFBQVFDLE9BQU8sT0FBT2tFLFVBQVUsTUFBTyxXQUN0QyxNQUFPLFVBQVVNLEVBQU91RSxFQUFNQyxHQUM3QkEsRUFBTUMsU0FBUyxNQUFPLFNBQVVDLEdBQy9CSCxFQUFLSSxLQUFLLElBQUtELFFBR2ZoRixVQUFVLE9BQVEsV0FDcEIsTUFBTyxVQUFVTSxFQUFPdUUsRUFBTUMsR0FDN0JBLEVBQU1DLFNBQVMsT0FBUSxTQUFVRyxHQUNoQ0wsRUFBS0ksS0FBSyxLQUFNQyxRQUdoQmxGLFVBQVUsTUFBTyxXQUNuQixNQUFPLFVBQVVNLEVBQU91RSxFQUFNQyxHQUM3QkEsRUFBTUMsU0FBUyxNQUFPLFNBQVU5RCxHQUMvQjRELEVBQUtJLEtBQUssSUFBS2hFLFFBR2ZqQixVQUFVLE1BQU8sV0FDbkIsTUFBTyxVQUFVTSxFQUFPdUUsRUFBTUMsR0FDN0JBLEVBQU1DLFNBQVMsTUFBTyxTQUFVN0QsR0FDL0IyRCxFQUFLSSxLQUFLLElBQUsvRCxRQUdmbEIsVUFBVSxPQUFRLFdBQ3BCLE1BQU8sVUFBVU0sRUFBT3VFLEVBQU1DLEdBQzdCQSxFQUFNQyxTQUFTLE9BQVEsU0FBVUksR0FDaENOLEVBQUtJLEtBQUssS0FBTUUsUUFHaEJuRixVQUFVLE1BQU8sV0FDbkIsTUFBTyxVQUFVTSxFQUFPdUUsRUFBTUMsR0FDN0JBLEVBQU1DLFNBQVMsTUFBTyxTQUFVSyxHQUMvQlAsRUFBS0ksS0FBSyxJQUFLRyxRQUdmcEYsVUFBVSxTQUFVLFdBQ3RCLE1BQU8sVUFBVU0sRUFBT3VFLEVBQU1DLEdBQzdCQSxFQUFNQyxTQUFTLFNBQVUsU0FBVW5HLEdBQ2xDaUcsRUFBS0ksS0FBSyxPQUFRckciLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgWyduZ0FuaW1hdGUnLCAnbmdNYXRlcmlhbCcsICduZ01lc3NhZ2VzJywgJ3VpLnJvdXRlciddKTtcbi8vbGV0IG1haW5DdHJsID0gcmVxdWlyZSgnLi9jb250cm9sbGVycy9tYWluQ3RybCcpO1xuLy9cbi8vYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ21haW5DdHJsJywgbWFpbkN0cmwpO1xuXCJ1c2Ugc3RyaWN0XCI7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdG1haW5DdHJsLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCBcImNvbmZpZ0ZhY3RvcnlcIl07XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdtYWluQ3RybCcsIG1haW5DdHJsKTtcblxuXHRmdW5jdGlvbiBtYWluQ3RybCgkc2NvcGUsICRodHRwLCBjb25maWdGYWN0b3J5KSB7XG5cdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cdFx0dGhpcy4kaHR0cCA9ICRodHRwO1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnRmFjdG9yeTtcblxuXHRcdHRoaXMuZGdDb25maWcgPSB7XG5cdFx0XHR3aWR0aDogMzAwLFxuXHRcdFx0aGVpZ2h0OiAzMDAsXG5cdFx0XHRyYWRpdXM6IDExMCxcblx0XHRcdHN0ZXBSYWRpdXM6IDE1XG5cdFx0fTtcblxuXHRcdHRoaXMuaW5pdCgpO1xuXHR9XG5cblx0bWFpbkN0cmwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdHRoaXMuJGh0dHAuZ2V0KHRoaXMuY29uZmlnLmZpeHR1cmVzICsgJ2NvdW50cmllcy5qc29uJykudGhlbihmdW5jdGlvbiAocmVzcCkge1xuXHRcdFx0X3RoaXMuY291bnRyaWVzID0gcmVzcC5kYXRhO1xuXHRcdFx0X3RoaXMuY051bSA9IDA7XG5cdFx0fSk7XG5cblx0XHR0aGlzLiRodHRwLmdldCh0aGlzLmNvbmZpZy5maXh0dXJlcyArICdvdGhlcmluZm8uanNvbicpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcblx0XHRcdF90aGlzLmluZm8yID0gcmVzcC5kYXRhO1xuXHRcdFx0X3RoaXMuaU51bSA9IDA7XG5cdFx0fSk7XG5cdH07XG5cblx0bWFpbkN0cmwucHJvdG90eXBlLnNldENvdW50cnkgPSBmdW5jdGlvbiAoZSwgaWR4KSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHRoaXMuY051bSA9IGlkeDtcblx0fTtcblxuXHRtYWluQ3RybC5wcm90b3R5cGUuc2V0SW5mbzJJdGVtID0gZnVuY3Rpb24gKGUsIGlkeCkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHR0aGlzLmlOdW0gPSBpZHg7XG5cdH07XG5cblx0bWFpbkN0cmwucHJvdG90eXBlLmNhbGxiYWNrQ2xpY2sgPSBmdW5jdGlvbiAoaXRlbSkge1xuXHRcdGNvbnNvbGUubG9nKCctLS09PT0gaXRlbSA9PT0tLS0nLCBpdGVtKTtcblx0fTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdjb25maWdGYWN0b3J5JywgZnVuY3Rpb24gKCkge1xuXHRcdHZhciBwYXRoID0ge1xuXHRcdFx0Zml4dHVyZXM6ICcuL3NyYy9maXh0dXJlcy8nLFxuXHRcdFx0Y29tcG9uZW50czogJy4vc3JjL2NvbXBvbmVudHMvJ1xuXHRcdH07XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0Zml4dHVyZXM6IHBhdGguZml4dHVyZXMsXG5cdFx0XHRjb21wb25lbnRzOiBwYXRoLmNvbXBvbmVudHNcblx0XHR9O1xuXHR9KTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCduZ0RnUHJlc2V0c0ZhY3RvcnknLCBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHdpZHRoID0gNTAwO1xuXHRcdHZhciBoZWlnaHQgPSA1MDA7XG5cblx0XHR2YXIgcHJlc2V0cyA9IHtcblx0XHRcdHBhdGhDb2xvcnM6IHsgMDogJyNmNThhNDEnLCAxOiAnI2YwZDM2NycsIDI6ICcjZTY0ZDFiJyB9LFxuXHRcdFx0c3ZnV2lkdGg6IHdpZHRoLFxuXHRcdFx0c3ZnSGVpZ2h0OiBoZWlnaHQsXG5cdFx0XHRzdmdTdHlsZXM6IHtcblx0XHRcdFx0J3dpZHRoJzogd2lkdGgsXG5cdFx0XHRcdCdoZWlnaHQnOiBoZWlnaHQsXG5cdFx0XHRcdCdmaWxsJzogJ2JsdWUnXG5cdFx0XHR9LFxuXHRcdFx0cmFkaXVzOiAxNTUsXG5cdFx0XHRhbmltYXRlVGltZTogNTAwLFxuXHRcdFx0YW5pbWF0ZVN0ZXA6IDEsXG5cdFx0XHRzUmFkaXVzOiAzMFxuXHRcdH07XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0cGF0aENvbG9yczogcHJlc2V0cy5wYXRoQ29sb3JzLFxuXHRcdFx0c3ZnV2lkdGg6IHByZXNldHMuc3ZnV2lkdGgsXG5cdFx0XHRzdmdIZWlnaHQ6IHByZXNldHMuc3ZnSGVpZ2h0LFxuXHRcdFx0c3ZnU3R5bGVzOiBwcmVzZXRzLnN2Z1N0eWxlcyxcblx0XHRcdHJhZGl1czogcHJlc2V0cy5yYWRpdXMsXG5cdFx0XHRhbmltYXRlVGltZTogcHJlc2V0cy5hbmltYXRlVGltZSxcblx0XHRcdGFuaW1hdGVTdGVwOiBwcmVzZXRzLmFuaW1hdGVTdGVwLFxuXHRcdFx0c1JhZGl1czogcHJlc2V0cy5zUmFkaXVzXG5cdFx0fTtcblx0fSk7XG59KSgpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoW1wiJHN0YXRlUHJvdmlkZXJcIiwgXCIkdXJsUm91dGVyUHJvdmlkZXJcIiwgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblx0XHR2YXIgcGF0aFRvQ29tcG9uZW50cyA9ICcuL3NyYy9jb21wb25lbnRzLyc7XG5cblx0XHQkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG5cblx0XHR2YXIgbWFpblZpZXcgPSB7XG5cdFx0XHRcIm1haW5cIjoge1xuXHRcdFx0XHR0ZW1wbGF0ZVVybDogcGF0aFRvQ29tcG9uZW50cyArICdtYWluL2luZGV4Lmh0bWwnXG5cdFx0XHRcdC8vdGVtcGxhdGVVcmw6IGNvbmZpZ0ZhY3RvcnkuY29tcG9uZW50cyArICdkaWFncmFtbVBhZ2UvZGlhZ3JhbW1QYWdlLmh0bWwnXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lJywge1xuXHRcdFx0dXJsOiAnLycsXG5cdFx0XHR2aWV3czogbWFpblZpZXdcblx0XHR9KTtcblx0fV0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0bmdEaWFncmFtbUN0cmwuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIm5nRGdQcmVzZXRzRmFjdG9yeVwiXTtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ25nRGlhZ3JhbW1DdHJsJywgbmdEaWFncmFtbUN0cmwpO1xuXG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ25nRGlhZ3JhbW0nLCBbXCJjb25maWdGYWN0b3J5XCIsIGZ1bmN0aW9uIChjb25maWdGYWN0b3J5KSB7XG5cdFx0dmFyIG5nRGcgPSAnbmdEaWFncmFtbSc7XG5cblx0XHRmdW5jdGlvbiBuZ0RpYWdyYW1tTGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHt9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0bGluazogbmdEaWFncmFtbUxpbmssXG5cdFx0XHRzY29wZToge30sXG5cdFx0XHR0ZW1wbGF0ZVVybDogY29uZmlnRmFjdG9yeS5jb21wb25lbnRzICsgbmdEZyArICcvJyArIG5nRGcgKyAnLmh0bWwnLFxuXHRcdFx0Y29udHJvbGxlcjogbmdEaWFncmFtbUN0cmwsXG5cdFx0XHRjb250cm9sbGVyQXM6ICdkZycsXG5cdFx0XHRiaW5kVG9Db250cm9sbGVyOiB7XG5cdFx0XHRcdGRhdGE6ICc9PycsXG5cdFx0XHRcdHN0eWxlczogJz0/Jyxcblx0XHRcdFx0d2lkdGg6ICdAPycsXG5cdFx0XHRcdGhlaWdodDogJ0A/Jyxcblx0XHRcdFx0cmFkaXVzOiAnQD8nLFxuXHRcdFx0XHRzdGVwUmFkaXVzOiAnQD8nLFxuXHRcdFx0XHRwYXRoQ2xpY2tDYjogJz0/Jyxcblx0XHRcdFx0Y3R4OiAnPT8nLFxuXHRcdFx0XHRuYW1lOiAnQD8nXG5cdFx0XHR9XG5cdFx0fTtcblx0fV0pO1xuXG5cdGZ1bmN0aW9uIG5nRGlhZ3JhbW1DdHJsKCRzY29wZSwgbmdEZ1ByZXNldHNGYWN0b3J5KSB7XG5cdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXHRcdGlmICghdGhpcy5wYXRoQ2xpY2spIHRoaXMucGF0aENsaWNrID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Y29uc29sZS5sb2coJ9Ca0L7Qu9C70LHQtdC6INC/0L4g0LrQu9C40LrRgyDQvdC1INC30LDQtNCw0L0nKTtcblx0XHR9O1xuXHRcdC8qKlxuICAgKiDQlNC10YTQvtC70YLQvdGL0LUg0L3QsNGB0YLRgNC+0LnQutC4INC00LvRjyDQtNC40YDQtdC60YLQuNCy0LrQuFxuICAgKi9cblx0XHR0aGlzLnBycyA9IG5nRGdQcmVzZXRzRmFjdG9yeTtcblxuXHRcdHRoaXMuaW5pdCgpO1xuXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRfdGhpcy5wYXJhbVdhdGNoZXIoKTtcblx0XHR9LCAxNTAwKTtcblx0fVxuXG5cdC8qKlxuICAqINCh0YLQsNGA0YLRg9C10LxcbiAgKi9cblx0bmdEaWFncmFtbUN0cmwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIF90aGlzMiA9IHRoaXM7XG5cblx0XHQvKipcbiAgICog0JzQsNGB0YHQuNCyINGC0Y3Qs9C+IDxnPiwg0LrQvtGC0L7RgNGL0Lkg0YDQtdC90LTQtdGA0LjRgtGB0Y8g0LIg0YLQtdC80L/Qu9C10LnRgtC1XG4gICAqL1xuXHRcdHRoaXMucGF0aGVzID0gW107XG5cblx0XHQvKipcbiAgICog0JzQsNGB0YHQuNCyINGC0Y3Qs9C+IDxjaXJjbGU+XG4gICAqL1xuXHRcdHRoaXMuY2lyY2xlcyA9IFtdO1xuXG5cdFx0dmFyIGNvbmZpZyA9IHtcblx0XHRcdHdpZHRoOiArdGhpcy53aWR0aCB8fCB0aGlzLnBycy5zdmdXaWR0aCxcblx0XHRcdGhlaWdodDogK3RoaXMuaGVpZ2h0IHx8IHRoaXMucHJzLnN2Z0hlaWdodCxcblx0XHRcdHJhZGl1czogK3RoaXMucmFkaXVzIHx8IHRoaXMucHJzLnJhZGl1cyxcblx0XHRcdHNSYWRpdXM6ICt0aGlzLnN0ZXBSYWRpdXMgfHwgdGhpcy5wcnMuc1JhZGl1cyxcblx0XHRcdGNlbnRlcjogeyB4OiAoK3RoaXMud2lkdGggfHwgdGhpcy5wcnMuc3ZnV2lkdGgpIC8gMiwgeTogKCt0aGlzLmhlaWdodCB8fCB0aGlzLnBycy5zdmdIZWlnaHQpIC8gMiB9XG5cdFx0fTtcblxuXHRcdHRoaXMuJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gX3RoaXMyLmRhdGE7XG5cdFx0fSwgZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdGlmIChkYXRhKSB7XG5cdFx0XHRcdC8vVE9ETzog0J3QsNC/0LjRgdCw0YLRjCDQv9GA0L7QstC10YDQutGDINC90LAg0YHRg9C80LzRgyDQv9GA0L7RhtC10L3RgtC+0LJcblxuXHRcdFx0XHRpZiAoX3RoaXMyLnBhdGhlcyAmJiBfdGhpczIucGF0aGVzLmxlbmd0aCkgX3RoaXMyLnBhdGhlcy5sZW5ndGggPSAwO1xuXG5cdFx0XHRcdGlmICghX3RoaXMyLmNpcmNsZXMubGVuZ3RoKSBfdGhpczIuY3JlYXRlQ2lyY2xlcyhjb25maWcpO1xuXG5cdFx0XHRcdHZhciBhcnIgPSBbXSxcblx0XHRcdFx0ICAgIGFuZ2xlc0FyciA9IFtdO1xuXG5cdFx0XHRcdGZvciAodmFyIGtleSBpbiBkYXRhLmRhdGEpIHtcblx0XHRcdFx0XHRhcnIucHVzaCh7XG5cdFx0XHRcdFx0XHR2YWx1ZTogZGF0YS5kYXRhW2tleV0udmFsdWUsXG5cdFx0XHRcdFx0XHR0ZXh0OiBkYXRhLmRhdGFba2V5XS50ZXh0XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiDQodC+0LfQtNCw0LXQvCDRgdC10LrRgtC+0YDQsC4g0J/RgNC+0YbQtdC90YLRiyDQv9C10YDQtdCy0L7QtNC40Lwg0LIg0YDQsNC00LjQsNC90YtcbiAgICAgKiBhMSAtINC90LDRh9Cw0LvQviDRgdC10LrRgtC+0YDQsCwg0LAyID0g0LrQvtC90LXRhiDRgdC10LrRgtC+0YDQsFxuICAgICAqL1xuXHRcdFx0XHRmb3IgKHZhciBjID0gMCwgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0XHR2YXIgcHJpb3JpdHkgPSAwO1xuXHRcdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgYXJyLmxlbmd0aDsgaiArPSAxKSB7XG5cdFx0XHRcdFx0XHRpZiAoYXJyW2ldLnZhbHVlIDwgYXJyW2pdLnZhbHVlKSBwcmlvcml0eSArPSAxO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRhbmdsZXNBcnIucHVzaCh7IGExOiBjICogMy42LCBhMjogKGMgKyBhcnJbaV0udmFsdWUpICogMy42LCB0ZXh0OiBhcnJbaV0udGV4dCwgdmFsdWU6IGFycltpXS52YWx1ZSwgc1JhZGl1czogcHJpb3JpdHkgfSk7IC8vINCf0LXRgNC10LLQvtC00LjQvCDQs9GA0LDQtNGD0YHRiyDQsiDQs9GA0LDQtNC40LXQvdGC0Ytcblx0XHRcdFx0XHRjICs9IGFycltpXS52YWx1ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZvciAodmFyIF9pID0gMDsgX2kgPCBhbmdsZXNBcnIubGVuZ3RoOyBfaSArPSAxKSB7XG5cdFx0XHRcdFx0dmFyIGNvb3JkcyA9IHsgeDE6ICcnLCB5MTogJycsIHgyOiAnJywgeTI6ICcnIH07XG5cblx0XHRcdFx0XHR2YXIgX2FyciA9IF90aGlzMi5jYWxjdWxhdGVBYnNDb29yZChhbmdsZXNBcnJbX2ldLmExLCBjb25maWcuY2VudGVyLCBjb25maWcucmFkaXVzIC0gYW5nbGVzQXJyW19pXS5zUmFkaXVzICogY29uZmlnLnNSYWRpdXMpO1xuXHRcdFx0XHRcdGNvb3Jkcy54MSA9IF9hcnJbMF07XG5cdFx0XHRcdFx0Y29vcmRzLnkxID0gX2FyclsxXTtcblxuXHRcdFx0XHRcdF9hcnIgPSBfdGhpczIuY2FsY3VsYXRlQWJzQ29vcmQoYW5nbGVzQXJyW19pXS5hMiwgY29uZmlnLmNlbnRlciwgY29uZmlnLnJhZGl1cyAtIGFuZ2xlc0FycltfaV0uc1JhZGl1cyAqIGNvbmZpZy5zUmFkaXVzKTtcblx0XHRcdFx0XHRjb29yZHMueDIgPSBfYXJyWzBdO1xuXHRcdFx0XHRcdGNvb3Jkcy55MiA9IF9hcnJbMV07XG5cblx0XHRcdFx0XHRmb3IgKHZhciBfa2V5IGluIGNvb3Jkcykge1xuXHRcdFx0XHRcdFx0Y29vcmRzW19rZXldID0gTWF0aC5yb3VuZChjb29yZHNbX2tleV0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiDQodCy0L7QudGB0YLQstC+LCDQutC+0YLQvtGA0L7QtSDQutC+0YDQvNC40Lwg0L3QsCDQstGM0Y7RhdGDINC00LvRjyDQvtGC0YDQuNGB0L7QstC60Lgg0YHQtdC60YLQvtGA0LBcbiAgICAgICovXG5cdFx0XHRcdFx0dmFyIHRleHRDcmQgPSBfdGhpczIuY2FsY3VsYXRlQWJzQ29vcmQoKGFuZ2xlc0FycltfaV0uYTEgKyBhbmdsZXNBcnJbX2ldLmEyKSAvIDIsIGNvbmZpZy5jZW50ZXIsIChjb25maWcucmFkaXVzIC0gX2kgKiBjb25maWcuc1JhZGl1cykgLyAyKTtcblxuXHRcdFx0XHRcdHZhciB0ZW1wbGF0ZSA9IHtcblx0XHRcdFx0XHRcdGlkOiAnZ18nICsgKF9pICsgMSksXG5cdFx0XHRcdFx0XHRjb2xvcjogX3RoaXMyLnBycy5wYXRoQ29sb3JzW2FuZ2xlc0FycltfaV0uc1JhZGl1c10sXG5cdFx0XHRcdFx0XHR2YWx1ZTogYW5nbGVzQXJyW19pXS52YWx1ZSxcblx0XHRcdFx0XHRcdHRleHQ6IGFuZ2xlc0FycltfaV0udGV4dCxcblx0XHRcdFx0XHRcdHJhZGl1czogY29uZmlnLnJhZGl1cyAtIGFuZ2xlc0FycltfaV0uc1JhZGl1cyAqIGNvbmZpZy5zUmFkaXVzLFxuXHRcdFx0XHRcdFx0c2hvd1Rvb2x0aXA6IGZhbHNlLFxuXHRcdFx0XHRcdFx0YW5nbGU6IHtcblx0XHRcdFx0XHRcdFx0c3RhcnQ6IGFuZ2xlc0FycltfaV0uYTEsXG5cdFx0XHRcdFx0XHRcdGVuZDogYW5nbGVzQXJyW19pXS5hMlxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdHN0YXJ0UG9zOiB7XG5cdFx0XHRcdFx0XHRcdHg6IGNvb3Jkcy54MSxcblx0XHRcdFx0XHRcdFx0eTogY29vcmRzLnkxXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0ZW5kUG9zOiB7XG5cdFx0XHRcdFx0XHRcdHg6IGNvb3Jkcy54Mixcblx0XHRcdFx0XHRcdFx0eTogY29vcmRzLnkyXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0dGV4dFBvc2l0aW9uOiB7XG5cdFx0XHRcdFx0XHRcdHg6IHRleHRDcmRbMF0sXG5cdFx0XHRcdFx0XHRcdHk6IHRleHRDcmRbMV1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0X3RoaXMyLnBhdGhlcy5wdXNoKHRlbXBsYXRlKTtcblxuXHRcdFx0XHRcdF90aGlzMi5wYXRoQW5pbWF0aW9uKF90aGlzMi5wYXRoZXNbX2ldLCBjb25maWcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cblx0LyoqXG4gICog0KTRg9C90LrRhtC40Y8g0LLQvtC30LLRgNCw0YnQsNC10YIg0LzQsNGB0YHQuNCyINC40Lcg0LTQstGD0YUg0YfQuNGB0LXQuyAo0LrQvtC+0YDQtNC40L3QsNGC0YsgeCDQuCDRgylcbiAgKiDQmtC+0L7RgNC00LjQvdCw0YLRiyDRgNCw0YHRgdGH0LjRgtGL0LLQsNGO0YLRgdGPINC00LvRjyDQvtC/0YDQtdC00LXQu9GR0L3QvdC+0LPQviDRg9Cz0LvQsCDQvtGC0L3QvtGB0LjRgtC10LvRjNC90L4g0YbQtdC90YLRgNCwINC00LjQsNCz0YDQsNC80LzRiy5cbiAgKiDQo9GH0LjRgtGL0LLQsNC10Lwg0YDQsNC00LjRg9GBXG4gICovXG5cdG5nRGlhZ3JhbW1DdHJsLnByb3RvdHlwZS5jYWxjdWxhdGVBYnNDb29yZCA9IGZ1bmN0aW9uIChhbmdsZSwgY2VudGVyLCByYWRpdXMpIHtcblx0XHR2YXIgYXJyID0gW107XG5cdFx0aWYgKGFuZ2xlID49IDAgJiYgYW5nbGUgPCA5MCkge1xuXHRcdFx0YXJyWzBdID0gY2VudGVyLnggKyBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5zaW4oYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdFx0YXJyWzFdID0gY2VudGVyLnkgLSBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5jb3MoYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdH0gZWxzZSBpZiAoYW5nbGUgPj0gOTAgJiYgYW5nbGUgPCAxODApIHtcblx0XHRcdGFyclswXSA9IGNlbnRlci54ICsgTWF0aC5hYnMocmFkaXVzICogK01hdGguc2luKGFuZ2xlICogTWF0aC5QSSAvIDE4MCkudG9QcmVjaXNpb24oMTApKTtcblx0XHRcdGFyclsxXSA9IGNlbnRlci55ICsgTWF0aC5hYnMocmFkaXVzICogK01hdGguY29zKGFuZ2xlICogTWF0aC5QSSAvIDE4MCkudG9QcmVjaXNpb24oMTApKTtcblx0XHR9IGVsc2UgaWYgKGFuZ2xlID49IDE4MCAmJiBhbmdsZSA8IDI3MCkge1xuXHRcdFx0YXJyWzBdID0gY2VudGVyLnggLSBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5zaW4oYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdFx0YXJyWzFdID0gY2VudGVyLnkgKyBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5jb3MoYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdH0gZWxzZSBpZiAoYW5nbGUgPj0gMjcwICYmIGFuZ2xlIDw9IDM2MCkge1xuXHRcdFx0YXJyWzBdID0gY2VudGVyLnggLSBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5zaW4oYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdFx0YXJyWzFdID0gY2VudGVyLnkgLSBNYXRoLmFicyhyYWRpdXMgKiArTWF0aC5jb3MoYW5nbGUgKiBNYXRoLlBJIC8gMTgwKS50b1ByZWNpc2lvbigxMCkpO1xuXHRcdH1cblx0XHRyZXR1cm4gYXJyO1xuXHR9O1xuXG5cdC8qKlxuICAqINCh0L7Qt9C00LDQtdC8INC80LDRgdGB0LjQsiDQv9GD0L3QutGC0LjRgNC90YvRhSDQutC+0LvQtdGGXG4gICovXG5cdG5nRGlhZ3JhbW1DdHJsLnByb3RvdHlwZS5jcmVhdGVDaXJjbGVzID0gZnVuY3Rpb24gKGNvbmZpZykge1xuXHRcdGZvciAodmFyIGkgPSBjb25maWcuc1JhZGl1czsgaSA8IGNvbmZpZy53aWR0aDsgaSArPSBjb25maWcuc1JhZGl1cykge1xuXHRcdFx0dGhpcy5jaXJjbGVzLnB1c2goe1xuXHRcdFx0XHRjZW50ZXI6IHtcblx0XHRcdFx0XHR4OiBjb25maWcud2lkdGggLyAyLFxuXHRcdFx0XHRcdHk6IGNvbmZpZy5oZWlnaHQgLyAyXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHJhZGl1czogaVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXG5cdC8qKlxuICAqINCk0YPQvdC60YbQuNGPINCw0L3QuNC80LDRhtC40LhcbiAgKi9cblx0bmdEaWFncmFtbUN0cmwucHJvdG90eXBlLnBhdGhBbmltYXRpb24gPSBmdW5jdGlvbiAocGF0aCwgY29uZmlnKSB7XG5cdFx0dmFyIF9zZWxmID0gdGhpcztcblx0XHR2YXIgY3VycmVudEFuZ2xlID0gcGF0aC5hbmdsZS5zdGFydDtcblx0XHR2YXIgdGltZVN0ZXAgPSB0aGlzLnBycy5hbmltYXRlVGltZSAvICgocGF0aC5hbmdsZS5lbmQgLSBwYXRoLmFuZ2xlLnN0YXJ0KSAvIHRoaXMucHJzLmFuaW1hdGVTdGVwKTtcblxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0cGF0aC5zaG93VG9vbHRpcCA9IHBhdGguYW5nbGUuZW5kIC0gcGF0aC5hbmdsZS5zdGFydCA+IDE1O1xuXHRcdFx0Ly9fc2VsZi4kc2NvcGUuJGRpZ2VzdCgpO1xuXHRcdH0sIDUwMCk7XG5cblx0XHR2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gZigpIHtcblx0XHRcdGlmIChjdXJyZW50QW5nbGUgPj0gcGF0aC5hbmdsZS5lbmQpIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICog0KHQvNC10YnQsNC10Lwg0YHQtdC60YLQvtGAINC90LAg0LfQsNC00LDQvdGL0Lkg0YjQsNCzINC4INC/0YDQvtCy0LXRgNGP0LXQvCwg0YfRgtC+0LHRiyDRg9Cz0L7QuyDQvdC1INC/0YDQtdCy0YvRiNCw0Lsg0LfQvdCw0YfQtdC90LjQtSDRg9Cz0LvQsCDQv9GA0LDQstC+0LPQviDQutGA0LDRjyDRgdC10LrRgtC+0YDQsFxuICAgICovXG5cdFx0XHRjdXJyZW50QW5nbGUgKz0gX3NlbGYucHJzLmFuaW1hdGVTdGVwO1xuXHRcdFx0aWYgKGN1cnJlbnRBbmdsZSA+IHBhdGguYW5nbGUuZW5kKSBjdXJyZW50QW5nbGUgPSBwYXRoLmFuZ2xlLmVuZDtcblxuXHRcdFx0LyoqXG4gICAgKiDQodC80L7RgtGA0LjQvCwg0LrQsNC60YPRjiDRh9Cw0YHRgtGMINC00YPQs9C4INC+0YLRgNC40YHQvtCy0YvQstCw0YLRjC4g0JXRgdC70Lgg0LTRg9Cz0LAg0LzQtdC90YzRiNC1IDE4MCDQs9GA0LDQtNGD0YHQvtCyIC0g0YHRgtCw0LLQuNC8INGE0LvQsNCzINC90LAg0L7RgtGA0LjRgdC+0LLQutGDINC80LXQvdGM0YjQtdC5INGB0YLQvtGA0L7QvdGLXG4gICAgKi9cblx0XHRcdHBhdGguZmxhZyA9IGN1cnJlbnRBbmdsZSAtIHBhdGguYW5nbGUuc3RhcnQgPD0gMTgwID8gMCA6IDE7XG5cblx0XHRcdC8qKlxuICAgICog0KLQtdC60YPRidCw0Y8g0LrQvtC+0YDQtNC40L3QsNGC0LAg0YHQvNC10YnQtdC90LjRjyDQtNGD0LPQuFxuICAgICovXG5cdFx0XHR2YXIgY3VycmVudENvb3JkcyA9IF9zZWxmLmNhbGN1bGF0ZUFic0Nvb3JkKGN1cnJlbnRBbmdsZSwgY29uZmlnLmNlbnRlciwgcGF0aC5yYWRpdXMpO1xuXHRcdFx0cGF0aC5zZXR0aW5ncyA9ICdNICcgKyBjb25maWcuY2VudGVyLnggKyAnLCcgKyBjb25maWcuY2VudGVyLnkgKyAnIEwgJyArICcnICsgcGF0aC5zdGFydFBvcy54ICsgJywnICsgcGF0aC5zdGFydFBvcy55ICsgJyBBJyArICcnICsgcGF0aC5yYWRpdXMgKyAnLCcgKyBwYXRoLnJhZGl1cyArICcgMCAnICsgJycgKyBwYXRoLmZsYWcgKyAnLCAxICcgKyBjdXJyZW50Q29vcmRzWzBdICsgJywnICsgY3VycmVudENvb3Jkc1sxXSArICcnO1xuXG5cdFx0XHQvKipcbiAgICAqINCg0LXQutGD0YDRgdC40Lwg0YLQsNC50LzQsNGD0YJcbiAgICAqL1xuXHRcdFx0dGltZW91dCA9IHNldFRpbWVvdXQoZiwgdGltZVN0ZXApO1xuXG5cdFx0XHQvKipcbiAgICAqINCe0LHQvdC+0LLQu9GP0LXQvCDQstGM0Y7RhdGDXG4gICAgKi9cblx0XHRcdF9zZWxmLiRzY29wZS4kZGlnZXN0KCk7XG5cdFx0fSwgdGltZVN0ZXApO1xuXHR9O1xuXG5cdC8qKlxuICAqINCa0L7Qu9C70LHQtdC6INC60LvQuNC60LBcbiAgKi9cblx0bmdEaWFncmFtbUN0cmwucHJvdG90eXBlLnBhdGhDbGljayA9IGZ1bmN0aW9uIChlLCBpdGVtKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHRoaXMucGF0aENsaWNrQ2IuY2FsbCh0aGlzLmN0eCwgaXRlbSk7XG5cdH07XG5cblx0bmdEaWFncmFtbUN0cmwucHJvdG90eXBlLnBhcmFtV2F0Y2hlciA9IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgX3RoaXMzID0gdGhpcztcblxuXHRcdHZhciBkZWZlbmQgPSBmYWxzZTtcblx0XHR2YXIgZGVmVGltZSA9IDEwMDA7XG5cblx0XHR0aGlzLiRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuXHRcdFx0cmV0dXJuIF90aGlzMy53aWR0aDtcblx0XHR9LCBmdW5jdGlvbiAod2lkdGgpIHtcblx0XHRcdGRlZmVuZCA9IGZhbHNlO1xuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGRlZmVuZCA9IHRydWU7X3RoaXMzLiRzY29wZS4kZGlnZXN0KCk7XG5cdFx0XHR9LCBkZWZUaW1lKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gX3RoaXMzLmhlaWdodDtcblx0XHR9LCBmdW5jdGlvbiAoaGVpZ2h0KSB7XG5cdFx0XHRkZWZlbmQgPSBmYWxzZTtcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRkZWZlbmQgPSB0cnVlO190aGlzMy4kc2NvcGUuJGRpZ2VzdCgpO1xuXHRcdFx0fSwgZGVmVGltZSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLiRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuXHRcdFx0cmV0dXJuIF90aGlzMy5yYWRpdXM7XG5cdFx0fSwgZnVuY3Rpb24gKHJhZGl1cykge1xuXHRcdFx0ZGVmZW5kID0gZmFsc2U7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0ZGVmZW5kID0gdHJ1ZTtfdGhpczMuJHNjb3BlLiRkaWdlc3QoKTtcblx0XHRcdH0sIGRlZlRpbWUpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy4kc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiBfdGhpczMuc3RlcFJhZGl1cztcblx0XHR9LCBmdW5jdGlvbiAoc3RlcFJhZGl1cykge1xuXHRcdFx0ZGVmZW5kID0gZmFsc2U7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0ZGVmZW5kID0gdHJ1ZTtfdGhpczMuJHNjb3BlLiRkaWdlc3QoKTtcblx0XHRcdH0sIGRlZlRpbWUpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy4kc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiBkZWZlbmQ7XG5cdFx0fSwgZnVuY3Rpb24gKGRlZikge1xuXHRcdFx0aWYgKGRlZikgX3RoaXMzLmluaXQoKTtcblx0XHR9KTtcblx0fTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ25nUicsIGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24gKHNjb3BlLCBlbGVtLCBhdHRycykge1xuXHRcdFx0YXR0cnMuJG9ic2VydmUoJ25nUicsIGZ1bmN0aW9uIChyKSB7XG5cdFx0XHRcdGVsZW0uYXR0cigncicsIHIpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSkuZGlyZWN0aXZlKCduZ0N4JywgZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG5cdFx0XHRhdHRycy4kb2JzZXJ2ZSgnbmdDeCcsIGZ1bmN0aW9uIChjeCkge1xuXHRcdFx0XHRlbGVtLmF0dHIoJ2N4JywgY3gpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSkuZGlyZWN0aXZlKCduZ1gnLCBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbSwgYXR0cnMpIHtcblx0XHRcdGF0dHJzLiRvYnNlcnZlKCduZ1gnLCBmdW5jdGlvbiAoeCkge1xuXHRcdFx0XHRlbGVtLmF0dHIoJ3gnLCB4KTtcblx0XHRcdH0pO1xuXHRcdH07XG5cdH0pLmRpcmVjdGl2ZSgnbmdZJywgZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG5cdFx0XHRhdHRycy4kb2JzZXJ2ZSgnbmdZJywgZnVuY3Rpb24gKHkpIHtcblx0XHRcdFx0ZWxlbS5hdHRyKCd5JywgeSk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KS5kaXJlY3RpdmUoJ25nQ3knLCBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbSwgYXR0cnMpIHtcblx0XHRcdGF0dHJzLiRvYnNlcnZlKCduZ0N5JywgZnVuY3Rpb24gKGN5KSB7XG5cdFx0XHRcdGVsZW0uYXR0cignY3knLCBjeSk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KS5kaXJlY3RpdmUoJ25nRCcsIGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24gKHNjb3BlLCBlbGVtLCBhdHRycykge1xuXHRcdFx0YXR0cnMuJG9ic2VydmUoJ25nRCcsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdGVsZW0uYXR0cignZCcsIGQpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSkuZGlyZWN0aXZlKCduZ0ZpbGwnLCBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbSwgYXR0cnMpIHtcblx0XHRcdGF0dHJzLiRvYnNlcnZlKCduZ0ZpbGwnLCBmdW5jdGlvbiAoZmlsbCkge1xuXHRcdFx0XHRlbGVtLmF0dHIoJ2ZpbGwnLCBmaWxsKTtcblx0XHRcdH0pO1xuXHRcdH07XG5cdH0pO1xufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
